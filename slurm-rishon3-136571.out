cpu-bind=MASK - rishon3, task  0  0 [42085]: mask 0x100000001 set
cpu-bind=MASK - rishon3, task  0  0 [42085]: mask 0x100000001 set
*** SLURM BATCH JOB 'test_job' STARTING ***
*** Activating environment cs236605-hw ***
Using device: cuda
File /home/natsala/.pytorch-datasets/lfw-bush.zip exists, skipping download.
Extracting /home/natsala/.pytorch-datasets/lfw-bush.zip...
Extracted 531 to /home/natsala/.pytorch-datasets/lfw/George_W_Bush
--- EPOCH 1/200 ---
train_batch:   0%|          | 0/8 [00:00<?, ?it/s]THCudaCheck FAIL file=/opt/conda/conda-bld/pytorch_1535493744281/work/aten/src/THC/THCGeneral.cpp line=663 error=11 : invalid argument
train_batch (1.343):   0%|          | 0/8 [00:00<?, ?it/s]train_batch (1.343):  12%|█▎        | 1/8 [00:00<00:03,  2.18it/s]train_batch (4.611):  12%|█▎        | 1/8 [00:00<00:03,  2.18it/s]train_batch (4.611):  25%|██▌       | 2/8 [00:00<00:02,  2.36it/s]train_batch (0.833):  25%|██▌       | 2/8 [00:01<00:02,  2.36it/s]train_batch (0.833):  38%|███▊      | 3/8 [00:01<00:02,  2.48it/s]train_batch (0.659):  38%|███▊      | 3/8 [00:01<00:02,  2.48it/s]train_batch (0.659):  50%|█████     | 4/8 [00:01<00:01,  2.59it/s]train_batch (0.474):  50%|█████     | 4/8 [00:02<00:01,  2.59it/s]train_batch (0.474):  62%|██████▎   | 5/8 [00:02<00:01,  2.28it/s]train_batch (0.853):  62%|██████▎   | 5/8 [00:02<00:01,  2.28it/s]train_batch (0.853):  75%|███████▌  | 6/8 [00:02<00:00,  2.43it/s]train_batch (0.372):  75%|███████▌  | 6/8 [00:02<00:00,  2.43it/s]train_batch (0.372):  88%|████████▊ | 7/8 [00:02<00:00,  2.54it/s]train_batch (0.559):  88%|████████▊ | 7/8 [00:02<00:00,  2.54it/s]train_batch (0.559): 100%|██████████| 8/8 [00:02<00:00,  3.07it/s]train_batch (Avg. Loss 1.213, Accuracy 4.6): 100%|██████████| 8/8 [00:02<00:00,  3.07it/s]
test_batch:   0%|          | 0/1 [00:00<?, ?it/s]test_batch (0.664):   0%|          | 0/1 [00:00<?, ?it/s]test_batch (0.664): 100%|██████████| 1/1 [00:00<00:00,  3.71it/s]test_batch (Avg. Loss 0.664, Accuracy 5.8): 100%|██████████| 1/1 [00:00<00:00,  3.71it/s]/home/natsala/miniconda3/envs/cs236605-hw/lib/python3.7/site-packages/torch/nn/modules/upsampling.py:122: UserWarning: nn.Upsampling is deprecated. Use nn.functional.interpolate instead.
  warnings.warn("nn.Upsampling is deprecated. Use nn.functional.interpolate instead.")

Traceback (most recent call last):
  File "trainVAE.py", line 132, in <module>
    post_epoch_fn=post_epoch_fn)
  File "/home/natsala/cs236605-hw3/hw3/training.py", line 111, in fit
    post_epoch_fn(epoch, train_result, test_result, verbose)
  File "trainVAE.py", line 120, in post_epoch_fn
    samples = vae.sample(n=5)
  File "/home/natsala/cs236605-hw3/hw3/autoencoder.py", line 214, in sample
    samples = self.decode(z)
  File "/home/natsala/cs236605-hw3/hw3/autoencoder.py", line 194, in decode
    h = torch.mm(z,self.Dec_T) + self.Dec_b
RuntimeError: Expected object of type torch.FloatTensor but found type torch.cuda.FloatTensor for argument #2 'mat2'
*** SLURM BATCH JOB 'test_job' DONE ***
